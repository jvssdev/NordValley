import Quickshell
import Quickshell.Wayland
import Quickshell.Io
import QtQuick

ShellRoot {
    NotificationService {}
    MprisService {}
    IdleService {}

    WaylandWindow {
        id: notificationCenter
        visible: false

        PanelWindow {
            anchors { top: true; right: true; margins: 10 }
            width: 400
            height: 600
            color: "#@base00@"

            NotificationCenter { anchors.fill: parent }
        }
    }

    // Reactive toggle using file watcher â€“ instant & zero polling-free
    File {
        id: toggleFile
        path: "/tmp/quickshell-toggle-cmd"
        onContentChanged: {
            notificationCenter.visible = !notificationCenter.visible
            content = "" // consume the event (prevents double-toggle on rapid key presses)
        }
    }

    Component.onCompleted: {
        toggleFile.content = "" // ensure file exists and is empty on start
        NotificationService.updateStatusFile()
    }
}
